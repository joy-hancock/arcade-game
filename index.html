<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CAM Game</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Orbitron:wght@400..900&family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="gameContainer">
      <form>
        <input type="radio" name="screen" id="start" checked />
        <input type="radio" name="screen" id="game" />
        <input type="radio" name="screen" id="end" />

        <div class="screen screen-start">
          <p>Oops! You clicked on a simulated phishing test!</p>
          <div>
            <h1 class="retro">Welcome to the<br />Awareness Arcade</h1>
            <h2>
              Click the Red Flags with the spaceship and avoid the Arcade
              Villains to keep your organization safe!
            </h2>
          </div>
          <label for="game" class="play buttonish">
            <?xml version="1.0" encoding="UTF-8"?>
            <svg
              id="Layer_2"
              data-name="Layer 2"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 49.42 56.55"
            >
              <defs>
                <style>
                  .cls-1 {
                    fill: #fff;
                  }
                </style>
              </defs>
              <g id="Layer_1-2" data-name="Layer 1">
                <polygon
                  class="cls-1"
                  points="9.88 50.1 19.77 50.1 19.77 44.47 29.65 44.47 29.65 39.26 39.53 39.26 39.53 33.77 49.42 33.77 49.42 22.79 39.53 22.79 39.53 17.3 29.65 17.3 29.65 12.08 19.77 12.08 19.77 6.45 9.88 6.45 9.88 0 0 0 0 56.55 9.88 56.55 9.88 50.1"
                />
              </g>
            </svg>
            <span>New Game</span>
          </label>
        </div>

        <div class="screen screen-game">
          <div class="flags red-flags">
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 1"
              id="1"
              name="flag1"
              value="1"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 2"
              id="2"
              name="flag2"
              value="2"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 3"
              id="3"
              name="flag3"
              value="3"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 4"
              id="4"
              name="flag4"
              value="4"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 5"
              id="5"
              name="flag5"
              value="5"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 6"
              id="6"
              name="flag6"
              value="6"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 7"
              id="7"
              name="flag7"
              value="7"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 8"
              id="8"
              name="flag8"
              value="8"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 9"
              id="9"
              name="flag9"
              value="9"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 10"
              id="10"
              name="flag10"
              value="10"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 11"
              id="11"
              name="flag11"
              value="11"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 12"
              id="12"
              name="flag12"
              value="12"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 13"
              id="13"
              name="flag13"
              value="13"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 14"
              id="14"
              name="flag14"
              value="14"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 15"
              id="15"
              name="flag15"
              value="15"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 16"
              id="16"
              name="flag16"
              value="16"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 17"
              id="17"
              name="flag17"
              value="17"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 18"
              id="18"
              name="flag18"
              value="18"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 19"
              id="19"
              name="flag19"
              value="19"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 20"
              id="20"
              name="flag20"
              value="20"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 21"
              id="21"
              name="flag21"
              value="21"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 22"
              id="22"
              name="flag22"
              value="22"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 23"
              id="23"
              name="flag23"
              value="23"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 24"
              id="24"
              name="flag24"
              value="24"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 25"
              id="25"
              name="flag25"
              value="25"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 26"
              id="26"
              name="flag26"
              value="26"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag red-flag"
              style="--i: 27"
              id="27"
              name="flag27"
              value="27"
              tabindex="-1"
            />
          </div>
          <div class="flags enkryptors">
            <input
              type="checkbox"
              class="flag enkryptor"
              style="--i: 1"
              id="1"
              name="flag1"
              value="1"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag enkryptor"
              style="--i: 2"
              id="2"
              name="flag2"
              value="2"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag enkryptor"
              style="--i: 3"
              id="3"
              name="flag3"
              value="3"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag enkryptor"
              style="--i: 4"
              id="4"
              name="flag4"
              value="4"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag enkryptor"
              style="--i: 5"
              id="5"
              name="flag5"
              value="5"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag enkryptor"
              style="--i: 6"
              id="6"
              name="flag6"
              value="6"
              tabindex="-1"
            />
          </div>
          <div class="flags cyberpunks">
            <input
              type="checkbox"
              class="flag cyberpunk"
              style="--i: 1"
              id="1"
              name="flag1"
              value="1"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag cyberpunk"
              style="--i: 2"
              id="2"
              name="flag2"
              value="2"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag cyberpunk"
              style="--i: 3"
              id="3"
              name="flag3"
              value="3"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag cyberpunk"
              style="--i: 4"
              id="4"
              name="flag4"
              value="4"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag cyberpunk"
              style="--i: 5"
              id="5"
              name="flag5"
              value="5"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag cyberpunk"
              style="--i: 6"
              id="6"
              name="flag6"
              value="6"
              tabindex="-1"
            />
          </div>
          <div class="flags deepfakes">
            <input
              type="checkbox"
              class="flag deepfake"
              style="--i: 1"
              id="1"
              name="flag1"
              value="1"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag deepfake"
              style="--i: 2"
              id="2"
              name="flag2"
              value="2"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag deepfake"
              style="--i: 3"
              id="3"
              name="flag3"
              value="3"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag deepfake"
              style="--i: 4"
              id="4"
              name="flag4"
              value="4"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag deepfake"
              style="--i: 5"
              id="5"
              name="flag5"
              value="5"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag deepfake"
              style="--i: 6"
              id="6"
              name="flag6"
              value="6"
              tabindex="-1"
            />
          </div>
          <div class="flags doppelgangers">
            <input
              type="checkbox"
              class="flag doppelganger"
              style="--i: 1"
              id="1"
              name="flag1"
              value="1"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag doppelganger"
              style="--i: 2"
              id="2"
              name="flag2"
              value="2"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag doppelganger"
              style="--i: 3"
              id="3"
              name="flag3"
              value="3"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag doppelganger"
              style="--i: 4"
              id="4"
              name="flag4"
              value="4"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag doppelganger"
              style="--i: 5"
              id="5"
              name="flag5"
              value="5"
              tabindex="-1"
            />
            <input
              type="checkbox"
              class="flag doppelganger"
              style="--i: 6"
              id="6"
              name="flag6"
              value="6"
              tabindex="-1"
            />
          </div>

          <div class="gui">
            <div class="timer"><span></span></div>
            <div class="score">Score:&nbsp;</div>
          </div>
        </div>

        <div class="screen screen-end">
          <div class="screen-end-text">
            <h2 class="font-secondary retro">Game Over</h2>

            <p class="final-score">
              Red Flags caught: <span id="final-score"></span>
            </p>
            <p class="good">
              Great job! You stopped the Arcade Villains and kept your
              organization safe!
            </p>
          </div>
          <button type="reset" class="buttonish">
            <span>Play Again</span>
          </button>
          <p class="disclaimer">
            "Please Note: This message came from KnowBe4, Inc. Organizations
            that are referenced in the email message have no association with
            KnowBe4, Inc. and do not endorse the services of KnowBe4, Inc. The
            purpose of this message is to demonstrate how phishing attacks can
            appear to be legitimate emails from reputable companies.
          </p>
        </div>
      </form>
    </div>

    <!-- <script src="app.js"></script> -->
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const explosionImg = new Image();
        explosionImg.src =
          'https://helpimg.s3.us-east-1.amazonaws.com/landing_pages/CSAM/2025/arcade/explode.png';

        const flags = document.querySelectorAll('.red-flag');
        const scoreElement = document.querySelector('.score');
        const restartButton = document.querySelector('button[type="reset"]');
        let score = 0;

        // Store original styles for each flag
        const originalStyles = [];
        flags.forEach((flag) => {
          originalStyles.push(flag.getAttribute('style') || '');
        });

        // Initialize score display
        scoreElement.setAttribute('data-score', '0');

        // Reset handler
        restartButton.addEventListener('click', function () {
          score = 0;
          scoreElement.setAttribute('data-score', '0');

          // Reset all flags to their original state
          flags.forEach((flag, index) => {
            flag.checked = false;
            flag.setAttribute('style', originalStyles[index]);
            flag.style.visibility = 'visible';
            flag.style.pointerEvents = 'auto';
            flag.style.opacity = '1';
          });
        });

        flags.forEach((flag, index) => {
          flag.addEventListener('click', function (e) {
            e.preventDefault();
            e.stopPropagation();

            // IMMEDIATELY disable further clicks
            this.style.pointerEvents = 'none';

            // Increment score
            score++;
            scoreElement.setAttribute('data-score', score.toString());

            // Update final score immediately
            const finalScoreEl = document.getElementById('final-score');
            if (finalScoreEl) {
              finalScoreEl.textContent = score;
            }

            // Get the current computed position before we change anything
            const currentTranslate = window.getComputedStyle(this).translate;
            const currentRotate = window.getComputedStyle(this).rotate;

            // Apply styles immediately
            this.setAttribute(
              'style',
              `
        ${originalStyles[index]}
        animation: none !important;
        background-color: transparent !important;
        background-image: none !important;
        transform: scale(1.5) !important;
        opacity: 1 !important;
        z-index: 100 !important;
        width: clamp(60px, 8vw, 120px) !important;
        height: clamp(60px, 8vw, 120px) !important;
        background-size: contain !important;
        background-repeat: no-repeat !important;
        background-position: center !important;
        translate: ${currentTranslate} !important;
        rotate: ${currentRotate} !important;
        pointer-events: none !important;
      `
            );

            requestAnimationFrame(() => {
              this.style.backgroundImage =
                "url('https://helpimg.s3.us-east-1.amazonaws.com/landing_pages/CSAM/2025/arcade/explode.png')";

              setTimeout(() => {
                this.style.transition = 'opacity 0.15s ease';
                this.style.opacity = '0';

                setTimeout(() => {
                  this.style.visibility = 'hidden';
                }, 150);
              }, 1500);
            });
          });
        });
      });
    </script>
  </body>
</html>
